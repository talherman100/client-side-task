{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\\\u05D8\\u05DC\\\\Desktop\\\\dotnet-react-web-socket-main\\\\factory-control\\\\ui\\\\src\\\\context\\\\WebSocket.js\",\n    _s = $RefreshSig$();\n\n/* eslint-disable react/jsx-no-constructed-context-values */\nimport React, { useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { BaseConfig } from '../config/AppConfig';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst WebSocketContext = /*#__PURE__*/React.createContext();\nconst WebSocketConsumer = WebSocketContext.Consumer;\n\nfunction WebSocketProvider(_ref) {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [wsState, setWsState] = useState(BaseConfig.webSocketState.NOTCONNECTED);\n  const [factoryList, setFactoryList] = useState([]);\n  const wsRef = useRef(); // start web socket connection in this function\n\n  const connectWs = () => {\n    setWsState(BaseConfig.webSocketState.CONNECTING);\n    wsRef.current = new WebSocket(BaseConfig.wsUrl);\n\n    wsRef.current.onopen = () => {\n      console.log('socket open');\n      setWsState(BaseConfig.webSocketState.OPEN);\n    };\n\n    wsRef.current.onmessage = e => {\n      console.log('message');\n      debugger;\n      console.log(e.data);\n      setFactoryList(JSON.parse(e.data));\n    };\n\n    wsRef.current.onclose = () => {\n      console.log('socket closed by server');\n      setWsState(BaseConfig.webSocketState.CLOSED);\n    };\n  };\n\n  const closeWs = () => {\n    wsRef.current.close();\n    console.log('socket closed by client');\n    setWsState(BaseConfig.webSocketState.CLOSED);\n  };\n\n  return /*#__PURE__*/_jsxDEV(WebSocketContext.Provider, {\n    value: {\n      connectWs,\n      closeWs,\n      wsState,\n      factoryList\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 46,\n    columnNumber: 5\n  }, this);\n}\n\n_s(WebSocketProvider, \"totAXVAFHTAseS4G7zUhSGn34GY=\");\n\n_c = WebSocketProvider;\nWebSocketProvider.propTypes = {\n  children: PropTypes.node.isRequired\n};\nexport { WebSocketContext, WebSocketConsumer, WebSocketProvider };\n\nvar _c;\n\n$RefreshReg$(_c, \"WebSocketProvider\");","map":{"version":3,"sources":["C:/Users/טל/Desktop/dotnet-react-web-socket-main/factory-control/ui/src/context/WebSocket.js"],"names":["React","useRef","useState","PropTypes","BaseConfig","WebSocketContext","createContext","WebSocketConsumer","Consumer","WebSocketProvider","children","wsState","setWsState","webSocketState","NOTCONNECTED","factoryList","setFactoryList","wsRef","connectWs","CONNECTING","current","WebSocket","wsUrl","onopen","console","log","OPEN","onmessage","e","data","JSON","parse","onclose","CLOSED","closeWs","close","propTypes","node","isRequired"],"mappings":";;;AAAA;AACA,OAAOA,KAAP,IAAgBC,MAAhB,EAAwBC,QAAxB,QAAwC,OAAxC;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,UAAT,QAA2B,qBAA3B;;AAEA,MAAMC,gBAAgB,gBAAGL,KAAK,CAACM,aAAN,EAAzB;AACA,MAAMC,iBAAiB,GAAGF,gBAAgB,CAACG,QAA3C;;AAEA,SAASC,iBAAT,OAAyC;AAAA;;AAAA,MAAd;AAAEC,IAAAA;AAAF,GAAc;AACvC,QAAM,CAACC,OAAD,EAAUC,UAAV,IAAwBV,QAAQ,CAACE,UAAU,CAACS,cAAX,CAA0BC,YAA3B,CAAtC;AACA,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgCd,QAAQ,CAAC,EAAD,CAA9C;AAEA,QAAMe,KAAK,GAAGhB,MAAM,EAApB,CAJuC,CAMvC;;AACA,QAAMiB,SAAS,GAAG,MAAM;AACtBN,IAAAA,UAAU,CAACR,UAAU,CAACS,cAAX,CAA0BM,UAA3B,CAAV;AAEAF,IAAAA,KAAK,CAACG,OAAN,GAAgB,IAAIC,SAAJ,CAAcjB,UAAU,CAACkB,KAAzB,CAAhB;;AAEAL,IAAAA,KAAK,CAACG,OAAN,CAAcG,MAAd,GAAuB,MAAM;AAC3BC,MAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AACAb,MAAAA,UAAU,CAACR,UAAU,CAACS,cAAX,CAA0Ba,IAA3B,CAAV;AACD,KAHD;;AAKAT,IAAAA,KAAK,CAACG,OAAN,CAAcO,SAAd,GAA0BC,CAAC,IAAI;AAC7BJ,MAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ;AACA;AACAD,MAAAA,OAAO,CAACC,GAAR,CAAYG,CAAC,CAACC,IAAd;AACAb,MAAAA,cAAc,CAACc,IAAI,CAACC,KAAL,CAAWH,CAAC,CAACC,IAAb,CAAD,CAAd;AACD,KALD;;AAOAZ,IAAAA,KAAK,CAACG,OAAN,CAAcY,OAAd,GAAwB,MAAM;AAC5BR,MAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ;AACAb,MAAAA,UAAU,CAACR,UAAU,CAACS,cAAX,CAA0BoB,MAA3B,CAAV;AACD,KAHD;AAID,GArBD;;AAuBA,QAAMC,OAAO,GAAG,MAAM;AACpBjB,IAAAA,KAAK,CAACG,OAAN,CAAce,KAAd;AACAX,IAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ;AACAb,IAAAA,UAAU,CAACR,UAAU,CAACS,cAAX,CAA0BoB,MAA3B,CAAV;AACD,GAJD;;AAMA,sBACE,QAAC,gBAAD,CAAkB,QAAlB;AAA2B,IAAA,KAAK,EAAE;AAAEf,MAAAA,SAAF;AAAagB,MAAAA,OAAb;AAAsBvB,MAAAA,OAAtB;AAA+BI,MAAAA;AAA/B,KAAlC;AAAA,cACGL;AADH;AAAA;AAAA;AAAA;AAAA,UADF;AAKD;;GAzCQD,iB;;KAAAA,iB;AA2CTA,iBAAiB,CAAC2B,SAAlB,GAA8B;AAC5B1B,EAAAA,QAAQ,EAAEP,SAAS,CAACkC,IAAV,CAAeC;AADG,CAA9B;AAIA,SAASjC,gBAAT,EAA2BE,iBAA3B,EAA8CE,iBAA9C","sourcesContent":["/* eslint-disable react/jsx-no-constructed-context-values */\nimport React, { useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { BaseConfig } from '../config/AppConfig';\n\nconst WebSocketContext = React.createContext();\nconst WebSocketConsumer = WebSocketContext.Consumer;\n\nfunction WebSocketProvider({ children }) {\n  const [wsState, setWsState] = useState(BaseConfig.webSocketState.NOTCONNECTED);\n  const [factoryList, setFactoryList] = useState([]);\n\n  const wsRef = useRef();\n\n  // start web socket connection in this function\n  const connectWs = () => {\n    setWsState(BaseConfig.webSocketState.CONNECTING);\n\n    wsRef.current = new WebSocket(BaseConfig.wsUrl);\n\n    wsRef.current.onopen = () => {\n      console.log('socket open');\n      setWsState(BaseConfig.webSocketState.OPEN);\n    };\n\n    wsRef.current.onmessage = e => {\n      console.log('message');\n      debugger;\n      console.log(e.data);\n      setFactoryList(JSON.parse(e.data));\n    };\n\n    wsRef.current.onclose = () => {\n      console.log('socket closed by server');\n      setWsState(BaseConfig.webSocketState.CLOSED);\n    };\n  };\n\n  const closeWs = () => {\n    wsRef.current.close();\n    console.log('socket closed by client');\n    setWsState(BaseConfig.webSocketState.CLOSED);\n  };\n\n  return (\n    <WebSocketContext.Provider value={{ connectWs, closeWs, wsState, factoryList }}>\n      {children}\n    </WebSocketContext.Provider>\n  );\n}\n\nWebSocketProvider.propTypes = {\n  children: PropTypes.node.isRequired,\n};\n\nexport { WebSocketContext, WebSocketConsumer, WebSocketProvider };\n"]},"metadata":{},"sourceType":"module"}