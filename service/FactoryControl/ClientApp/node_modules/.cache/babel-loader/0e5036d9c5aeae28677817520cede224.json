{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\\\u05D8\\u05DC\\\\Desktop\\\\dotnet-react-web-socket-main\\\\factory-control\\\\service\\\\FactoryControl\\\\ClientApp\\\\src\\\\context\\\\WebSocket.js\",\n    _s = $RefreshSig$();\n\n/* eslint-disable react/jsx-no-constructed-context-values */\nimport React, { useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { BaseConfig } from '../config/AppConfig';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst WebSocketContext = /*#__PURE__*/React.createContext();\nconst WebSocketConsumer = WebSocketContext.Consumer;\n\nfunction WebSocketProvider(_ref) {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [wsState, setWsState] = useState(BaseConfig.webSocketState.NOTCONNECTED);\n  const [photoList, setPhotoList] = useState([]);\n  const [currentGroup, setCurrentGroup] = useState(10);\n  const wsRef = useRef(); // start web socket connection in this function\n\n  const connectWs = () => {\n    setWsState(BaseConfig.webSocketState.CONNECTING);\n    wsRef.current = new WebSocket(BaseConfig.wsUrl);\n\n    wsRef.current.onopen = () => {\n      console.log('socket open');\n      setWsState(BaseConfig.webSocketState.OPEN);\n    };\n\n    wsRef.current.onmessage = e => {\n      console.log('message');\n      console.log(e.data);\n      setPhotoList(JSON.parse(e.data));\n    };\n\n    wsRef.current.onclose = () => {\n      console.log('socket closed by server');\n      setWsState(BaseConfig.webSocketState.CLOSED);\n    };\n  };\n\n  const closeWs = () => {\n    setCurrentGroup(10);\n    wsRef.current.close();\n    console.log('socket closed by client');\n    setWsState(BaseConfig.webSocketState.CLOSED);\n  };\n\n  return /*#__PURE__*/_jsxDEV(WebSocketContext.Provider, {\n    value: {\n      connectWs,\n      closeWs,\n      wsState,\n      photoList,\n      currentGroup\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 46,\n    columnNumber: 5\n  }, this);\n}\n\n_s(WebSocketProvider, \"/9Tzd9QZlDl5ycyFmp2zWRU56pc=\");\n\n_c = WebSocketProvider;\nWebSocketProvider.propTypes = {\n  children: PropTypes.node.isRequired\n};\nexport { WebSocketContext, WebSocketConsumer, WebSocketProvider };\n\nvar _c;\n\n$RefreshReg$(_c, \"WebSocketProvider\");","map":{"version":3,"sources":["C:/Users/טל/Desktop/dotnet-react-web-socket-main/factory-control/service/FactoryControl/ClientApp/src/context/WebSocket.js"],"names":["React","useRef","useState","PropTypes","BaseConfig","WebSocketContext","createContext","WebSocketConsumer","Consumer","WebSocketProvider","children","wsState","setWsState","webSocketState","NOTCONNECTED","photoList","setPhotoList","currentGroup","setCurrentGroup","wsRef","connectWs","CONNECTING","current","WebSocket","wsUrl","onopen","console","log","OPEN","onmessage","e","data","JSON","parse","onclose","CLOSED","closeWs","close","propTypes","node","isRequired"],"mappings":";;;AAAA;AACA,OAAOA,KAAP,IAAgBC,MAAhB,EAAwBC,QAAxB,QAAwC,OAAxC;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,UAAT,QAA2B,qBAA3B;;AAEA,MAAMC,gBAAgB,gBAAGL,KAAK,CAACM,aAAN,EAAzB;AACA,MAAMC,iBAAiB,GAAGF,gBAAgB,CAACG,QAA3C;;AAEA,SAASC,iBAAT,OAAyC;AAAA;;AAAA,MAAd;AAAEC,IAAAA;AAAF,GAAc;AACvC,QAAM,CAACC,OAAD,EAAUC,UAAV,IAAwBV,QAAQ,CAACE,UAAU,CAACS,cAAX,CAA0BC,YAA3B,CAAtC;AACA,QAAM,CAACC,SAAD,EAAYC,YAAZ,IAA4Bd,QAAQ,CAAC,EAAD,CAA1C;AACA,QAAM,CAACe,YAAD,EAAeC,eAAf,IAAkChB,QAAQ,CAAC,EAAD,CAAhD;AAEA,QAAMiB,KAAK,GAAGlB,MAAM,EAApB,CALuC,CAOvC;;AACA,QAAMmB,SAAS,GAAG,MAAM;AACtBR,IAAAA,UAAU,CAACR,UAAU,CAACS,cAAX,CAA0BQ,UAA3B,CAAV;AACAF,IAAAA,KAAK,CAACG,OAAN,GAAgB,IAAIC,SAAJ,CAAcnB,UAAU,CAACoB,KAAzB,CAAhB;;AAEAL,IAAAA,KAAK,CAACG,OAAN,CAAcG,MAAd,GAAuB,MAAM;AAC3BC,MAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AACAf,MAAAA,UAAU,CAACR,UAAU,CAACS,cAAX,CAA0Be,IAA3B,CAAV;AACD,KAHD;;AAKAT,IAAAA,KAAK,CAACG,OAAN,CAAcO,SAAd,GAA0BC,CAAC,IAAI;AAC7BJ,MAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ;AACAD,MAAAA,OAAO,CAACC,GAAR,CAAYG,CAAC,CAACC,IAAd;AACAf,MAAAA,YAAY,CAACgB,IAAI,CAACC,KAAL,CAAWH,CAAC,CAACC,IAAb,CAAD,CAAZ;AACD,KAJD;;AAMAZ,IAAAA,KAAK,CAACG,OAAN,CAAcY,OAAd,GAAwB,MAAM;AAC5BR,MAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ;AACAf,MAAAA,UAAU,CAACR,UAAU,CAACS,cAAX,CAA0BsB,MAA3B,CAAV;AACD,KAHD;AAID,GAnBD;;AAqBA,QAAMC,OAAO,GAAG,MAAM;AACpBlB,IAAAA,eAAe,CAAC,EAAD,CAAf;AACAC,IAAAA,KAAK,CAACG,OAAN,CAAce,KAAd;AACAX,IAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ;AACAf,IAAAA,UAAU,CAACR,UAAU,CAACS,cAAX,CAA0BsB,MAA3B,CAAV;AACD,GALD;;AAOA,sBACE,QAAC,gBAAD,CAAkB,QAAlB;AAA2B,IAAA,KAAK,EAAE;AAAEf,MAAAA,SAAF;AAAagB,MAAAA,OAAb;AAAsBzB,MAAAA,OAAtB;AAA+BI,MAAAA,SAA/B;AAA0CE,MAAAA;AAA1C,KAAlC;AAAA,cACGP;AADH;AAAA;AAAA;AAAA;AAAA,UADF;AAKD;;GAzCQD,iB;;KAAAA,iB;AA2CTA,iBAAiB,CAAC6B,SAAlB,GAA8B;AAC5B5B,EAAAA,QAAQ,EAAEP,SAAS,CAACoC,IAAV,CAAeC;AADG,CAA9B;AAIA,SAASnC,gBAAT,EAA2BE,iBAA3B,EAA8CE,iBAA9C","sourcesContent":["/* eslint-disable react/jsx-no-constructed-context-values */\nimport React, { useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { BaseConfig } from '../config/AppConfig';\n\nconst WebSocketContext = React.createContext();\nconst WebSocketConsumer = WebSocketContext.Consumer;\n\nfunction WebSocketProvider({ children }) {\n  const [wsState, setWsState] = useState(BaseConfig.webSocketState.NOTCONNECTED);\n  const [photoList, setPhotoList] = useState([]);\n  const [currentGroup, setCurrentGroup] = useState(10);\n\n  const wsRef = useRef();\n\n  // start web socket connection in this function\n  const connectWs = () => {\n    setWsState(BaseConfig.webSocketState.CONNECTING);\n    wsRef.current = new WebSocket(BaseConfig.wsUrl);\n\n    wsRef.current.onopen = () => {\n      console.log('socket open');\n      setWsState(BaseConfig.webSocketState.OPEN);\n    };\n\n    wsRef.current.onmessage = e => {\n      console.log('message');\n      console.log(e.data);\n      setPhotoList(JSON.parse(e.data));\n    };\n\n    wsRef.current.onclose = () => {\n      console.log('socket closed by server');\n      setWsState(BaseConfig.webSocketState.CLOSED);\n    };\n  };\n\n  const closeWs = () => {\n    setCurrentGroup(10);\n    wsRef.current.close();\n    console.log('socket closed by client');\n    setWsState(BaseConfig.webSocketState.CLOSED);\n  };\n\n  return (\n    <WebSocketContext.Provider value={{ connectWs, closeWs, wsState, photoList, currentGroup }}>\n      {children}\n    </WebSocketContext.Provider>\n  );\n}\n\nWebSocketProvider.propTypes = {\n  children: PropTypes.node.isRequired,\n};\n\nexport { WebSocketContext, WebSocketConsumer, WebSocketProvider };\n"]},"metadata":{},"sourceType":"module"}